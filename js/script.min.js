function initializeMap(){var a=document.getElementById("map"),b=new google.maps.LatLng(42.34852,-71.0823),c={center:b,zoom:12,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(a,c),ko.applyBindings(new viewModel)}function mapError(){alert("Unable to load Google Map API. Please try again later."),console.log("Google Map API is error")}var myLocations=[{name:"Prudential Center",lat:42.34852,lng:-71.0823,address:"800 Boylston St, Boston, MA 02199",neighborhood:"Boston, MA"},{name:"Central Library",lat:42.34942,lng:-71.07883,address:"700 Boylston St, Boston, MA 02116",neighborhood:"Boston, MA"},{name:"Boston Common",lat:42.34813,lng:-71.06776,address:"Tremont St, Boston, MA 02116",neighborhood:"Boston, MA"},{name:"AMC Loews Boston",lat:42.35313,lng:-71.06392,address:"175 Tremont St, Boston, MA 02111",neighborhood:"Boston, MA"},{name:"Museum of Fine Arts",lat:42.33946,lng:-71.09414,address:"465 Huntington Ave, Boston, MA 02115",neighborhood:"Boston, MA"},{name:"Museum of Science",lat:42.36773,lng:-71.07149,address:"1 1 Science Park, Boston, MA 02114",neighborhood:"Boston, MA"},{name:"Franklin Park Zoo",lat:42.30279,lng:-71.08681,address:"1 Franklin Park Rd, Boston, MA 02121",neighborhood:"Boston, MA"},{name:"Zoo New England",lat:42.30279,lng:-71.08681,address:"1 Franklin Park Rd, Dorchester, MA 02121",neighborhood:"Boston, MA"}],map,viewModel=function(){"use strict";var a=this;a.bostonList=ko.observableArray([]),a.filterBostonList=ko.observableArray([]),a.createBostonLocations=function(){myLocations.forEach(function(b){a.bostonList.push(new c(b))})},a.setBostonClick=function(){a.bostonList().forEach(function(b){google.maps.event.addListener(b.marker(),"click",function(){a.bostonClick(b)})})};var b=new google.maps.InfoWindow({content:'<div><h4 id="boston-name"></h4><p id="boston-address"></p><p id="yelp"></p></div>'});a.bostonClick=function(c){var d='<div><h4 id="boston-name">'+c.name()+'</h4><h5 id="boston-address">'+c.address()+'</h5><h6 id="boston-neighborhood">'+c.neighborhood()+'</h6><p id="text">Rating on <a id="yelp-url">yelp</a>: <img id="yelp"></p></div>';b.setContent(d),a.getYelpData(c),map.panTo(new google.maps.LatLng(c.lat(),c.lng())),b.open(map,c.marker()),a.setMarkerAnimation(c)},a.setMarkerAnimation=function(a){a.marker().setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){a.marker().setAnimation(null)},750)},a.filterBoston=function(){a.filterBostonList([]);for(var b=ko.observable("").val().toLowerCase(),c=a.bostonList().length,d=0;c>d;d++){var e=a.bostonList()[d].name().toLowerCase(),f=a.bostonList()[d].neighborhood().toLowerCase();e.indexOf(b)>-1||f.indexOf(b)>-1?(a.filterBostonList.push(a.bostonList()[d]),a.bostonList()[d].marker().setMap(map)):a.bostonList()[d].marker().setMap(null)}},a.getYelpData=function(a){var b="GET",c="http://api.yelp.com/v2/search/",d=function(a){for(var b="",c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",d=0;a>d;d++)b+=c.charAt(Math.floor(Math.random()*c.length));return b},e={oauth_consumer_key:"5AeOFx9AMNxBJTgnyBRi-A",oauth_token:"mwDAZhr4v2D1XIvr7279B-SfnVSjOZKp",oauth_nonce:d(20),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",callback:"cb",term:a.name(),location:"Boston, MA",limit:1},f="XbxEEnJF34PvOrbQ_o3Pr4UBwjM",g="isx3A_VZDb35nX0UzSTDC2wowQU",h=oauthSignature.generate(b,c,e,f,g);e.oauth_signature=h;var i={url:c,data:e,cache:!0,dataType:"jsonp",success:function(a){$("#yelp").attr("src",a.businesses[0].rating_img_url),$("#yelp-url").attr("href",a.businesses[0].url)},error:function(){$("#text").html("Unable to retrieve data from Yelp")}};$.ajax(i)},google.maps.event.addDomListener(window,"load",function(){a.createBostonLocations(),a.setBostonClick(),a.filterBostonList(),a.bostonList()});var c=function(a){var b;this.name=ko.observable(a.name),this.lat=ko.observable(a.lat),this.lng=ko.observable(a.lng),this.address=ko.observable(a.address),this.neighborhood=ko.observable(a.neighborhood),b=new google.maps.Marker({position:new google.maps.LatLng(this.lat(),this.lng()),map:map,title:this.name()}),this.marker=ko.observable(b)};a.query=ko.observable(""),a.filterBostonList=ko.computed(function(){return ko.utils.arrayFilter(a.bostonList(),function(b){var c=b.name().toLowerCase().indexOf(a.query().toLowerCase())>=0;return c?b.marker().setVisible(!0):b.marker().setVisible(!1),c})})};